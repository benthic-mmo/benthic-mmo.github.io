---
layout: default
title: About
---

<div class="bubble">
  <h1>Object Updates</h1>
  After authentication,
  <a
    href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html"
    >ObjectUpdate</a
  >
  packets will start streaming in from the server, representing other player
  avatars, furniture, environment data, etc.
  <br />
  <br />
  This is handled by the server's "interest list", which is a list of all objects in view of the user, as determined by the metaverse server.
  <br />
  <br />
  This is one of the largest packets sent by the server.

  <hr />
  <br />
  Not all of the ObjectUpdate fields will be used by every object. There are
  several unused fields in the packet such as
  <a
    href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#structfield.joint_type"
    >joint type</a
  >
  and
  <a
    href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#structfield.primitive_geometry"
    >primitive_geometry</a
  >. Some of the most useful elements of the ObjectUpdate packet are
  <div class="bubble-row">
    <div class="bubble contrast">
      <a
        href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#structfield.full_id"
      >
        <h2>full_id</h2>
      </a>
      The full UUID of the object. Can be used to retrieve the full mesh from
      the ViewerAsset endpoint.
    </div>

    <div class="bubble contrast">
      <a
        href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#structfield.pcode"
      >
        <h2>pcode</h2>
      </a>
      <p>
        This u8 number stores the object's
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/utils/object_types/enum.ObjectType.html"
          >type.</a
        >
      </p>
    </div>

    <div class="bubble contrast">
      <a
        href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#structfield.data"
        ><h2>data</h2></a
      >
      <p>
        the data can store an object's xy location and the velocity,
        acceleration, rotation, and angular velocity. These updates can be high,
        medium, and low precision updates, with foot collision planes and
        without. This is stored in the
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.MotionData.html#structfield.foot_collision_plane"
          >MotionData</a
        >
        object.
      </p>
    </div>
  </div>
  {% capture update %}
  <h2>Parsing Object Update</h2>
  Though the majority of the ObjectUpdate struct is straightforward, the MotionData
  portion of it can be difficult to parse correctly.
  <br />
  The type of update is determined by the length of the data field.
  <br />
  <br>
  <div class="bubble-row">
    <div class="bubble tertiary">
      <h2>High</h2>
      <div class="bubble sinister">
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html#high-precision-update-with-foot-collision-plane"
          ><h3>High Precision Update With Foot Collision Plane</h3></a
        >
        76 bytes
      </div>
      <div class="bubble sinister">
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html#high-precision-update"
          ><h3>High Precision Update</h3></a
        >
        60 bytes
      </div>
    </div>
    <div class="bubble tertiary">
      <h2>Medium</h2>
      <div class="bubble sinister">
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html#medium-precision-update-with-foot-collision-plane"
          ><h3>Medium Precision Update With Foot Collision Plane</h3></a
        >
        48 bytes
      </div>
      <div class="bubble sinister">
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html#medium-precision-update"
          ><h3>Medium Precision Update</h3></a
        >
        32 bytes
      </div>
    </div>
    <div class="bubble tertiary">
      <h2>Low</h2>
      <div class="bubble sinister">
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/index.html#low-precision-update"
          ><h3>Low Precision Update</h3></a
        >
        16 bytes
      </div>
    </div>
  </div>
  {% endcapture %} {% include evil_benthic.html content=update %}
</div>
<div class="bubble">
  <h1>Handling</h1>
  <div class="bubble-row">
    <div class="bubble contrast small">
      <h2>1.</h3>
      <p>
        The ObjectUpdate is
        <a
          href="https://github.com/benthic-mmo/metaverse_client/blob/7586490c87ca4e001d811be20673fc9b00e2a550/crates/core/src/transport/udp_handler.rs#L72"
          >received</a
        >
        from the UDP socket
      </p>
    </div>
    <div class="bubble contrast small">
      <h2>2.</h3>
      <p>
        ObjectUpdate is
        <a
          href="https://docs.rs/metaverse_messages/latest/metaverse_messages/udp/core/object_update/struct.ObjectUpdate.html#method.from_bytes"
          >parsed from bytes</a
        >
      </p>
    </div>
    <div class="bubble contrast small">
      <h2>2.</h2>
      <p>
        The
        <a
          href="https://docs.rs/metaverse_core/latest/metaverse_core/session/struct.Mailbox.html#impl-Handler%3CObjectUpdate%3E-for-Mailbox"
          >mailbox</a
        >
        determines the type of the object, and passes it along to its
        appropriate handler (Tree, <a href="/agent">Avatar</a>, Grass, etc...)
      </p>
    </div>
  </div>
</div>
